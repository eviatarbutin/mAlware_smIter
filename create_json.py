from our_dataset import OurDataset
from torch.utils.data import DataLoader
import torch
import json
import os

NEW_DATASET_DIRECTORY = "malimg_fixed_dataset_imgs"
JSON_NAME = "dataset.json"

def create_json(json_path):
    dataset = OurDataset()
    dirs = os.listdir(NEW_DATASET_DIRECTORY)
    for dir in dirs:
        dir_path = NEW_DATASET_DIRECTORY + "\\" + dir
        if os.path.isdir(NEW_DATASET_DIRECTORY + "\\" + dir):
            files = os.listdir(dir_path)
            for file in files:
                file_path = dir_path + "\\" + file
                if os.path.isfile(file_path) and file.endswith(".png"):
                    dataset.__add__(NEW_DATASET_DIRECTORY + "\\" + dir + "\\" + file)
    dataset.create_dataset_from_current_data(json_path)

if __name__ == "__main__":
    create_json("default.json")